<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cadastro Renda Mensal</title>
</head>
<body>
    <div>
    <h1>Cadastro de Renda Mensal</h1>

    <form method="POST">
        {% csrf_token %}
        {{form.as_p}}
        <button type="submit">Salvar</button>
    </form>

    <h2>Filtrar por período</h2>
    <form method="get">
        <label for="mes">Mês:</label>
        <select name="mes" id="mes">{% for i, nome in meses %}
       <option value="{{ i }}" {% if mes == i %}selected{% endif %}>{{i|stringformat:"02d"}} - {{ nome }}</option>
       {% endfor %}
       </select>

       <label for="ano">Ano</label>
       <input type="number" name="ano" id="ano" value="{{ ano}}" min="2000" max="2100"/>

       <button type="submit">Filtrar</button>
       <a href="{% url 'cadastro_renda' %}">Limpar</a>
    </form>

    <h2>Listagem das Rendas ({{mes|stringformat:"02d"}}/{{ ano }})</h2>
    <table border="1" cellpadding="5" cellspacing="0">
        <thead>
            <tr>
                <th>Mês</th>
                <th>Valor</th>
                <th>Tipo</th>
                <th>Data de Recebimento</th>                
                <th>Ações</th>
            </tr>
        </thead>
        <tbody>
            {% for renda in rendas %}
            <tr>
                <td>{{ renda.mes }}</td>
                <td>R$ {{ renda.valor }}</td>
                <td>{{ renda.get_tipo_display }}</td>
                <td>{{ renda.data_recebimento }}</td>
                <td>{{ renda.observacoes }}</td>
                <td>
                    <a href="{% url 'editar_renda' renda.id %}">Editar</a> |
                    <a href="{% url 'remover_renda' renda.id %}">Excluir</a>
                </td>
            </tr>
            {% empty %}
            <tr>
                <td colspan="5">Nenhum registro</td>
            </tr>
            {% endfor %}

        </tbody>
    </table>     
    </div>
    <h3>Renda total do mês ({{ mes|stringformat:"02d"}}/{{ ano }}): R$ {{ total }}</h3>
</body>
</html>